create table acl_sid(
    id bigint generated by default as identity(start with 100) not null primary key,
    principal boolean not null,
    sid varchar_ignorecase(100) not null,
    constraint unique_uk_1 unique(sid,principal));

create table acl_class(
    id bigint generated by default as identity(start with 100) not null primary key,
    class varchar_ignorecase(100) not null,
    constraint unique_uk_2 unique(class)
);

create table acl_object_identity(
    id bigint generated by default as identity(start with 100) not null primary key,
    object_id_class bigint not null,
    object_id_identity bigint not null,
    parent_object bigint,
    owner_sid bigint,
    entries_inheriting boolean not null,
    constraint unique_uk_3 unique(object_id_class,object_id_identity),
    constraint foreign_fk_1 foreign key(parent_object)references acl_object_identity(id),
    constraint foreign_fk_2 foreign key(object_id_class)references acl_class(id),
    constraint foreign_fk_3 foreign key(owner_sid)references acl_sid(id)
);

create table acl_entry(
    id bigint generated by default as identity(start with 100) not null primary key,
    acl_object_identity bigint not null,
    ace_order int not null,
    sid bigint not null,
    mask integer not null,
    granting boolean not null,
    audit_success boolean not null,
    audit_failure boolean not null,
    constraint unique_uk_4 unique(acl_object_identity,ace_order),
    constraint foreign_fk_4 foreign key(acl_object_identity) references acl_object_identity(id),
    constraint foreign_fk_5 foreign key(sid) references acl_sid(id)
);

CREATE TABLE CHAPTER (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		SLUGTITLE VARCHAR(255),
		TITLE VARCHAR(255),
		ID_BOOK BIGINT NOT NULL,
		CHAPTER_POSITION INTEGER
	);

CREATE TABLE BOOKACTIVITY (
		TYPE INTEGER,
		BOOK_ACTIVITY_ID BIGINT NOT NULL
	);

CREATE TABLE USER (
		ID_USER BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		EMAIL VARCHAR(255) NOT NULL,
		FULLNAME VARCHAR(255) NOT NULL,
		PASSWORD VARCHAR(255),
		USERNAME VARCHAR(255) NOT NULL
	);

CREATE TABLE ABSTRACTBOOKACTIVITY (
		ID BIGINT NOT NULL,
		ID_BOOK BIGINT NOT NULL
	);

CREATE TABLE CHAPTERACTIVITY (
		TYPE INTEGER,
		CHAPTER_ACTIVITY_ID BIGINT NOT NULL
	);

CREATE TABLE COMMENT (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		CONTENT VARCHAR(255),
		DOMID VARCHAR(255) NOT NULL,
		STATE VARCHAR(255) NOT NULL,
		TITLE VARCHAR(255),
		LABEL_ID BIGINT,
		PUBLICATION_ID BIGINT NOT NULL,
		USER_ID_USER BIGINT
	);

CREATE TABLE PUBLICATION (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		CONTENT LONGVARCHAR,
		PUBLISHED BOOLEAN NOT NULL,
		ID_CHAPTER BIGINT NOT NULL
	);

CREATE TABLE ACCOUNTACTIVITY (
		TYPE INTEGER,
		ACCOUNT_ACTIVITY_ID BIGINT NOT NULL
	);

CREATE TABLE ACTIVITY (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		RESOURCEUNAVAILABLE BOOLEAN,
		ID_USER BIGINT NOT NULL
	);

CREATE TABLE ABTRACTCHAPTERACTIVITY (
		ID BIGINT NOT NULL,
		CHAPTER_ID BIGINT NOT NULL
	);

CREATE TABLE COMMENTLABEL (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		LABEL VARCHAR(255)
	);

CREATE TABLE AUTHORITY_USER (
		AUTHORITY_ID BIGINT NOT NULL,
		USERS_ID_USER BIGINT NOT NULL
	);

CREATE TABLE BOOK (
		ID_BOOK BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		SLUGTITLE VARCHAR(255),
		TITLE VARCHAR(255),
		OWNER_ID_USER BIGINT
	);

CREATE TABLE BOOKAUTHOR (
		ID_BOOK BIGINT NOT NULL,
		ID_USER BIGINT NOT NULL
	);

CREATE TABLE USERAUTHORITY (
		USER_ID_USER BIGINT NOT NULL,
		AUTHORITIES_ID BIGINT NOT NULL
	);

CREATE TABLE COMMENTACTIVITY (
		TYPE INTEGER,
		COMMENT_ACTIVITY_ID BIGINT NOT NULL,
		COMMENT_ID BIGINT NOT NULL
	);

CREATE TABLE AUTHORITY (
		ID BIGINT NOT NULL,
		CREATIONDATE TIMESTAMP NOT NULL,
		DELETIONDATE TIMESTAMP,
		LASTMODIFIED TIMESTAMP,
		AUTHORITY VARCHAR(255)
	);

CREATE TABLE ACL_CLASS (
		ID BIGINT NOT NULL,
		CLASS VARCHAR_IGNORECASE(100) NOT NULL
	);

CREATE INDEX SYS_IDX_103 ON BOOKAUTHOR (null);

CREATE UNIQUE INDEX SYS_IDX_74 ON COMMENTLABEL (null);

CREATE UNIQUE INDEX SYS_IDX_46 ON ABSTRACTBOOKACTIVITY (null);

CREATE INDEX SYS_IDX_99 ON BOOK (null);

CREATE UNIQUE INDEX SYS_IDX_63 ON BOOKACTIVITY (null);

CREATE INDEX SYS_IDX_119 ON COMMENTACTIVITY (null);

CREATE INDEX SYS_IDX_111 ON COMMENT (null);

CREATE INDEX SYS_IDX_123 ON USERAUTHORITY (null);

CREATE UNIQUE INDEX SYS_IDX_133 ON ACL_OBJECT_IDENTITY (null);

CREATE UNIQUE INDEX SYS_IDX_72 ON COMMENTACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_59 ON BOOK (null);

CREATE UNIQUE INDEX SYS_IDX_UNIQUE_UK_2_132 ON ACL_CLASS (null);

CREATE UNIQUE INDEX SYS_IDX_UNIQUE_UK_1_129 ON ACL_SID (null);

CREATE INDEX SYS_IDX_136 ON ACL_OBJECT_IDENTITY (null);

CREATE INDEX SYS_IDX_109 ON CHAPTERACTIVITY (null);

CREATE INDEX SYS_IDX_101 ON BOOKACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_UNIQUE_UK_3_135 ON ACL_OBJECT_IDENTITY (null);

CREATE INDEX SYS_IDX_95 ON AUTHORITY_USER (null);

CREATE UNIQUE INDEX SYS_IDX_76 ON PUBLICATION (null);

CREATE INDEX SYS_IDX_89 ON ABTRACTCHAPTERACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_68 ON CHAPTERACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_52 ON ACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_UNIQUE_UK_4_144 ON ACL_ENTRY (null);

CREATE INDEX SYS_IDX_107 ON CHAPTER (null);

CREATE UNIQUE INDEX SYS_IDX_142 ON ACL_ENTRY (null);

CREATE UNIQUE INDEX SYS_IDX_48 ON ABTRACTCHAPTERACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_127 ON ACL_SID (null);

CREATE UNIQUE INDEX SYS_IDX_79 ON USER (null);

CREATE INDEX SYS_IDX_113 ON COMMENT (null);

CREATE INDEX SYS_IDX_117 ON COMMENTACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_50 ON ACCOUNTACTIVITY (null);

CREATE INDEX SYS_IDX_87 ON ABTRACTCHAPTERACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_SYS_CT_57_61 ON BOOK (null);

CREATE INDEX SYS_IDX_125 ON USERAUTHORITY (null);

CREATE INDEX SYS_IDX_105 ON BOOKAUTHOR (null);

CREATE INDEX SYS_IDX_91 ON ACCOUNTACTIVITY (null);

CREATE INDEX SYS_IDX_83 ON ABSTRACTBOOKACTIVITY (null);

CREATE INDEX SYS_IDX_97 ON AUTHORITY_USER (null);

CREATE INDEX SYS_IDX_145 ON ACL_ENTRY (null);

CREATE INDEX SYS_IDX_121 ON PUBLICATION (null);

CREATE UNIQUE INDEX SYS_IDX_54 ON AUTHORITY (null);

CREATE INDEX SYS_IDX_115 ON COMMENT (null);

CREATE INDEX SYS_IDX_138 ON ACL_OBJECT_IDENTITY (null);

CREATE INDEX SYS_IDX_93 ON ACTIVITY (null);

CREATE UNIQUE INDEX SYS_IDX_130 ON ACL_CLASS (null);

CREATE UNIQUE INDEX SYS_IDX_70 ON COMMENT (null);

CREATE INDEX SYS_IDX_85 ON ABSTRACTBOOKACTIVITY (null);

CREATE INDEX SYS_IDX_140 ON ACL_OBJECT_IDENTITY (null);

CREATE INDEX SYS_IDX_147 ON ACL_ENTRY (null);

CREATE UNIQUE INDEX SYS_IDX_66 ON CHAPTER (null);

CREATE UNIQUE INDEX SYS_IDX_SYS_CT_58_62 ON BOOK (null);

CREATE UNIQUE INDEX SYS_IDX_SYS_CT_78_81 ON USER (null);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FKA126572F35FE1083_94 UNIQUE (ID_USER);

ALTER TABLE COMMENTLABEL ADD CONSTRAINT SYS_REF_FK9BDE863F2821D64_114 UNIQUE (ID);

ALTER TABLE AUTHORITY ADD CONSTRAINT SYS_PK_55 PRIMARY KEY (ID);

ALTER TABLE ACL_CLASS ADD CONSTRAINT SYS_PK_131 PRIMARY KEY (ID);

ALTER TABLE ABSTRACTBOOKACTIVITY ADD CONSTRAINT SYS_PK_47 PRIMARY KEY (ID);

ALTER TABLE ACL_SID ADD CONSTRAINT SYS_REF_FOREIGN_FK_5_148 UNIQUE (ID);

ALTER TABLE ABTRACTCHAPTERACTIVITY ADD CONSTRAINT SYS_REF_FKCDF62E6ED35ED2AA_118 UNIQUE (ID);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT SYS_PK_134 PRIMARY KEY (ID);

ALTER TABLE BOOK ADD CONSTRAINT SYS_PK_60 PRIMARY KEY (ID_BOOK);

ALTER TABLE ACL_SID ADD CONSTRAINT SYS_REF_FOREIGN_FK_3_141 UNIQUE (ID);

ALTER TABLE ACTIVITY ADD CONSTRAINT SYS_PK_53 PRIMARY KEY (ID);

ALTER TABLE ACL_CLASS ADD CONSTRAINT SYS_REF_FOREIGN_FK_2_139 UNIQUE (ID);

ALTER TABLE PUBLICATION ADD CONSTRAINT SYS_REF_FK9BDE863F177EE9D1_112 UNIQUE (ID);

ALTER TABLE CHAPTER ADD CONSTRAINT SYS_REF_FK23254A0C92697C8D_122 UNIQUE (ID);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FK9BDE863F90EDA80F_116 UNIQUE (ID_USER);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FKFCA37F9890EDA80F_124 UNIQUE (ID_USER);

ALTER TABLE AUTHORITY ADD CONSTRAINT SYS_REF_FKFCA37F9817043793_126 UNIQUE (ID);

ALTER TABLE PUBLICATION ADD CONSTRAINT SYS_PK_77 PRIMARY KEY (ID);

ALTER TABLE BOOKACTIVITY ADD CONSTRAINT SYS_PK_64 PRIMARY KEY (BOOK_ACTIVITY_ID);

ALTER TABLE BOOK ADD CONSTRAINT SYS_REF_FK8F45142D35ECAEBF_108 UNIQUE (ID_BOOK);

ALTER TABLE ACCOUNTACTIVITY ADD CONSTRAINT SYS_PK_51 PRIMARY KEY (ACCOUNT_ACTIVITY_ID);

ALTER TABLE COMMENTACTIVITY ADD CONSTRAINT SYS_PK_73 PRIMARY KEY (COMMENT_ACTIVITY_ID);

ALTER TABLE AUTHORITY ADD CONSTRAINT SYS_REF_FKAE76EF877E9A3831_96 UNIQUE (ID);

ALTER TABLE ACL_ENTRY ADD CONSTRAINT SYS_PK_143 PRIMARY KEY (ID);

ALTER TABLE CHAPTER ADD CONSTRAINT SYS_REF_FKECE60849BDE90DB1_90 UNIQUE (ID);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FKE10A91F435FE1083_106 UNIQUE (ID_USER);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT SYS_REF_FOREIGN_FK_1_137 UNIQUE (ID);

ALTER TABLE USER ADD CONSTRAINT SYS_PK_80 PRIMARY KEY (ID_USER);

ALTER TABLE CHAPTERACTIVITY ADD CONSTRAINT SYS_PK_69 PRIMARY KEY (CHAPTER_ACTIVITY_ID);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FK1FAF0922A946F7_100 UNIQUE (ID_USER);

ALTER TABLE COMMENTLABEL ADD CONSTRAINT SYS_PK_75 PRIMARY KEY (ID);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT SYS_REF_FOREIGN_FK_4_146 UNIQUE (ID);

ALTER TABLE COMMENT ADD CONSTRAINT SYS_PK_71 PRIMARY KEY (ID);

ALTER TABLE ABSTRACTBOOKACTIVITY ADD CONSTRAINT SYS_REF_FK108EED388AD20BE5_102 UNIQUE (ID);

ALTER TABLE ABSTRACTBOOKACTIVITY ADD CONSTRAINT SYS_REF_FKECE60849F6AA250B_88 UNIQUE (ID);

ALTER TABLE ABTRACTCHAPTERACTIVITY ADD CONSTRAINT SYS_PK_49 PRIMARY KEY (ID);

ALTER TABLE ABTRACTCHAPTERACTIVITY ADD CONSTRAINT SYS_REF_FK841EEE5CC629EB98_110 UNIQUE (ID);

ALTER TABLE COMMENT ADD CONSTRAINT SYS_REF_FKCDF62E6EFF23FC71_120 UNIQUE (ID);

ALTER TABLE CHAPTER ADD CONSTRAINT SYS_PK_67 PRIMARY KEY (ID);

ALTER TABLE ACL_SID ADD CONSTRAINT SYS_PK_128 PRIMARY KEY (ID);

ALTER TABLE USER ADD CONSTRAINT SYS_REF_FKAE76EF875AE9BD4C_98 UNIQUE (ID_USER);

ALTER TABLE BOOK ADD CONSTRAINT SYS_REF_FKE10A91F435ECAEBF_104 UNIQUE (ID_BOOK);

ALTER TABLE ACTIVITY ADD CONSTRAINT SYS_REF_FK906A1C3CF959FEDE_92 UNIQUE (ID);

ALTER TABLE BOOK ADD CONSTRAINT SYS_REF_FK619CEE7A35ECAEBF_86 UNIQUE (ID_BOOK);

ALTER TABLE ACTIVITY ADD CONSTRAINT SYS_REF_FK619CEE7A313D8EC0_84 UNIQUE (ID);

ALTER TABLE COMMENTACTIVITY ADD CONSTRAINT FKCDF62E6ED35ED2AA FOREIGN KEY (COMMENT_ACTIVITY_ID)
	REFERENCES ABTRACTCHAPTERACTIVITY (ID);

ALTER TABLE ABTRACTCHAPTERACTIVITY ADD CONSTRAINT FKECE60849BDE90DB1 FOREIGN KEY (CHAPTER_ID)
	REFERENCES CHAPTER (ID);

ALTER TABLE PUBLICATION ADD CONSTRAINT FK23254A0C92697C8D FOREIGN KEY (ID_CHAPTER)
	REFERENCES CHAPTER (ID);

ALTER TABLE BOOKAUTHOR ADD CONSTRAINT FKE10A91F435ECAEBF FOREIGN KEY (ID_BOOK)
	REFERENCES BOOK (ID_BOOK);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT FOREIGN_FK_2 FOREIGN KEY (OBJECT_ID_CLASS)
	REFERENCES ACL_CLASS (ID);

ALTER TABLE CHAPTERACTIVITY ADD CONSTRAINT FK841EEE5CC629EB98 FOREIGN KEY (CHAPTER_ACTIVITY_ID)
	REFERENCES ABTRACTCHAPTERACTIVITY (ID);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT FOREIGN_FK_1 FOREIGN KEY (PARENT_OBJECT)
	REFERENCES ACL_OBJECT_IDENTITY (ID);

ALTER TABLE AUTHORITY_USER ADD CONSTRAINT FKAE76EF877E9A3831 FOREIGN KEY (AUTHORITY_ID)
	REFERENCES AUTHORITY (ID);

ALTER TABLE ACL_ENTRY ADD CONSTRAINT FOREIGN_FK_5 FOREIGN KEY (SID)
	REFERENCES ACL_SID (ID);

ALTER TABLE COMMENT ADD CONSTRAINT FK9BDE863F177EE9D1 FOREIGN KEY (PUBLICATION_ID)
	REFERENCES PUBLICATION (ID);

ALTER TABLE AUTHORITY_USER ADD CONSTRAINT FKAE76EF875AE9BD4C FOREIGN KEY (USERS_ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE ACL_OBJECT_IDENTITY ADD CONSTRAINT FOREIGN_FK_3 FOREIGN KEY (OWNER_SID)
	REFERENCES ACL_SID (ID);

ALTER TABLE ABTRACTCHAPTERACTIVITY ADD CONSTRAINT FKECE60849F6AA250B FOREIGN KEY (ID)
	REFERENCES ABSTRACTBOOKACTIVITY (ID);

ALTER TABLE CHAPTER ADD CONSTRAINT FK8F45142D35ECAEBF FOREIGN KEY (ID_BOOK)
	REFERENCES BOOK (ID_BOOK);

ALTER TABLE ACTIVITY ADD CONSTRAINT FKA126572F35FE1083 FOREIGN KEY (ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE COMMENT ADD CONSTRAINT FK9BDE863F90EDA80F FOREIGN KEY (USER_ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE BOOK ADD CONSTRAINT FK1FAF0922A946F7 FOREIGN KEY (OWNER_ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE ABSTRACTBOOKACTIVITY ADD CONSTRAINT FK619CEE7A35ECAEBF FOREIGN KEY (ID_BOOK)
	REFERENCES BOOK (ID_BOOK);

ALTER TABLE ACCOUNTACTIVITY ADD CONSTRAINT FK906A1C3CF959FEDE FOREIGN KEY (ACCOUNT_ACTIVITY_ID)
	REFERENCES ACTIVITY (ID);

ALTER TABLE BOOKAUTHOR ADD CONSTRAINT FKE10A91F435FE1083 FOREIGN KEY (ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE COMMENTACTIVITY ADD CONSTRAINT FKCDF62E6EFF23FC71 FOREIGN KEY (COMMENT_ID)
	REFERENCES COMMENT (ID);

ALTER TABLE ABSTRACTBOOKACTIVITY ADD CONSTRAINT FK619CEE7A313D8EC0 FOREIGN KEY (ID)
	REFERENCES ACTIVITY (ID);

ALTER TABLE ACL_ENTRY ADD CONSTRAINT FOREIGN_FK_4 FOREIGN KEY (ACL_OBJECT_IDENTITY)
	REFERENCES ACL_OBJECT_IDENTITY (ID);

ALTER TABLE USERAUTHORITY ADD CONSTRAINT FKFCA37F9817043793 FOREIGN KEY (AUTHORITIES_ID)
	REFERENCES AUTHORITY (ID);

ALTER TABLE USERAUTHORITY ADD CONSTRAINT FKFCA37F9890EDA80F FOREIGN KEY (USER_ID_USER)
	REFERENCES USER (ID_USER);

ALTER TABLE COMMENT ADD CONSTRAINT FK9BDE863F2821D64 FOREIGN KEY (LABEL_ID)
	REFERENCES COMMENTLABEL (ID);

ALTER TABLE BOOKACTIVITY ADD CONSTRAINT FK108EED388AD20BE5 FOREIGN KEY (BOOK_ACTIVITY_ID)
	REFERENCES ABSTRACTBOOKACTIVITY (ID);

